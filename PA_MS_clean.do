/**********************************************************************************File        : PA_MS_code.do  <--- this should be the exact name of THIS documentAuthor      : Kristina Tobio Created     : 23 Feb 2017Modified    : 24 Feb 2017Description : .do file for MS case**********************************************************************************/capture log closeclearset more offlog using "logs/ms_$S_DATE.log", replaceuse "data/PA_MS_data"/*replicating tables in the case*/tab functionsum totalcount emailcount  meetingcountsum totalcount_int emailcount_int meetingcount_intsum totalcount_ext emailcount_ext meetingcount_extkeep if function=="Sales"sum totalcount emailcount  meetingcountsum totalcount_int emailcount_int meetingcount_intsum totalcount_ext emailcount_ext meetingcount_extclear/*LOGS*/use "data/PA_MS_data"g ltotalcount=log(totalcount)g lattainment=log(attainment)regress attainment totalcountregress attainment ltotalcountregress lattainment ltotalregress attainment totalcount leveldum2-leveldum7 regiondum2-regiondum6 outreg2 using "reports/logs_$S_DATE", replace bdec(6) pvalue label excelregress attainment ltotalcount leveldum2-leveldum7 regiondum2-regiondum6 outreg2 using "reports/logs_$S_DATE", append bdec(6) pvalue label excelregress lattainment ltotal leveldum2-leveldum7 regiondum2-regiondum6 outreg2 using "reports/logs_$S_DATE", append bdec(6) pvalue label excelclearuse PA_MS_data, replacetab functiondstop/*levelsof function, local(levels)foreach l of local levels {regress attain_ totalcount if function=="`l'" }*/keep if function=="Sales"/*hist totalcount, freq*graph save "reports/totalcount", replacegraph export "reports/totalcount.png", replacepng2rtf using "reports/hist.doc", g("reports/totalcount.png") replace    erase totalcount.pnghist emailcount, freq*graph save "reports/emailcount"graph export "reports/emailcount.png", replacepng2rtf using "reports/hist.doc", g("reports/emailcount.png") append   erase emailcount.pnghist "reports/meetingcount", freq*graph save "reports/meetingcount", replacegraph export "reports/meetingcount.png", replacepng2rtf using "reports/hist.doc", g("reports/meetingcount.png") append    erase "reports/meetingcount.png"hist totalcount_ext, freq*graph save totalcount, appendgraph export totalcount_ext.png, replacepng2rtf using "hist.doc", g(totalcount_ext.png) append    erase totalcount_ext.pnghist emailcount_ext, freq*graph save emailcountgraph export emailcount_ext.png, replacepng2rtf using "hist.doc", g(emailcount_ext.png) append    erase emailcount_ext.pnghist meetingcount_ext, freq*graph save meetingcount, appendgraph export meetingcount_ext.png, replacepng2rtf using "hist.doc", g(meetingcount_ext.png) append    erase meetingcount_ext.pnghist totalcount_int, freq*graph save totalcount, appendgraph export totalcount_int.png, replacepng2rtf using "hist.doc", g(totalcount_int.png) append    erase totalcount_int.pnghist emailcount_int, freq*graph save emailcountgraph export emailcount_int.png, replacepng2rtf using "hist.doc", g(emailcount_int.png) append    erase emailcount_int.pnghist meetingcount_int, freq*graph save meetingcount, appendgraph export meetingcount_int.png, replacepng2rtf using "hist.doc", g(meetingcount_int.png) append    erase meetingcount_int.pngclear*/*drop if totalcount<1000*drop if totalcount>20000regress attain_ totalcount*outreg2 using "reports/MS_output_$S_DATE", replace bdec(6) pvalue label excel addnote("Missing indicators are level=Director; region=Central; Group=C")regress attain_ emailcount*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount_ext*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ emailcount_ext*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount_ext*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount_int*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ emailcount_int*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount_int*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount_ext totalcount_int*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ emailcount_ext emailcount_int*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount_ext meetingcount_int*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label exceloutreg2 using "reports/MS_output_$S_DATE", replace bdec(6) pvalue label excel addnote("Missing indicators are level=Director; region=Central; Group=C")regress attain_ emailcount leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount_ext leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ emailcount_ext leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount_ext leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount_int leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ emailcount_int leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount_int leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ totalcount_ext totalcount_int  leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ emailcount_ext emailcount_int  leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ meetingcount_ext meetingcount_int  leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ *total totalcount_ext *outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ *email emailcount_ext *outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ *mtg meetingcount_ext *outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ *total totalcount_ext  leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ *email  emailcount_ext leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_ *mtg meetingcount_ext leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excel foreach y in total mtg email {foreach x in PM HR Mkt Op GA Sales RD {regress attain_num  `x'`y' *outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_num  `x'`y' leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excel}}corr attain_num centralregress attain_num central*outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excelregress attain_num  central leveldum2-leveldum7 regiondum1-regiondum6 groupdum1 groupdum2outreg2 using "reports/MS_output_$S_DATE", append bdec(6) pvalue label excel